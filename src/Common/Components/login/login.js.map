{"version":3,"sources":["login.jsx"],"names":[],"mappings":"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","file":"login.js","sourcesContent":["let http = require(\"karl-http\");\r\nlet cookie = require(\"karl-cookie\");\r\nlet React = require(\"react\");\r\n\r\nclass login extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            username: \"\",\r\n            password: \"\",\r\n            tips: \"\",\r\n            loginRedirect: \"\"\r\n        };\r\n        let bindArr = [\"getCookieName\", \"submit\", \"usernameChange\", \"passwordChange\"];\r\n        bindArr.forEach(d=> {\r\n            this[d] = this[d].bind(this);\r\n        });\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.getCookieName();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"react-login\">\r\n                <div className=\"row\">\r\n                    <input value={this.state.username} onChange={this.usernameChange} placeholder=\"username\"\r\n                           type=\"text\"/>\r\n                </div>\r\n                <div className=\"row\">\r\n                    <input value={this.state.password} onChange={this.passwordChange} placeholder=\"password\"\r\n                           type=\"password\"/>\r\n                </div>\r\n                <div className=\"row\">\r\n                    <button onClick={this.submit}>sign in</button>\r\n                </div>\r\n                <div className=\"row\">\r\n                    <div className=\"tips\">{this.state.tips}</div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    getCookieName() {\r\n        //get cookie name from server\r\n        http.post(\"../account/getCookieName\").then(d=> {\r\n            let usernameCookie = cookie.get(d.username);\r\n            let passwordCookie = cookie.get(d.password);\r\n            usernameCookie = (usernameCookie == undefined) ? \"\" : usernameCookie;\r\n            passwordCookie = (passwordCookie == undefined) ? \"\" : passwordCookie;\r\n            this.setState({\r\n                username: usernameCookie,\r\n                password: passwordCookie,\r\n                loginRedirect: d.loginRedirect\r\n            });\r\n        }).catch(d=> {\r\n            this.setState({\"tips\": \"an error occured when set cookie:\" + d});\r\n        });\r\n    }\r\n\r\n    usernameChange(e) {\r\n        let d = e.target.value;\r\n        d = d.trim();\r\n        this.setState({\"username\": d});\r\n    }\r\n\r\n    passwordChange(e) {\r\n        let d = e.target.value;\r\n        d = d.trim();\r\n        this.setState({\"password\": d});\r\n    }\r\n\r\n    submit() {\r\n        let data = {\r\n            username: this.state.username,\r\n            password: this.state.password\r\n        };\r\n        http.post(\"../account/login\", data).then(d=> {\r\n            window.location.href = \"../\"+this.state.loginRedirect+\"/\";\r\n        }).catch(d=> {\r\n            this.setState({\"tips\": d});\r\n        });\r\n\r\n    }\r\n}\r\n\r\nmodule.exports = login;"]}