{"version":3,"sources":["session.es6"],"names":[],"mappings":";;AAAA,IAAI,UAAU,QAAQ,WAAR,CAAd;AACA,IAAI,WAAW,QAAQ,YAAR,CAAf;AACA,OAAO,OAAP,GAAiB,UAAC,GAAD,EAAM,GAAN,EAAW,IAAX,EAAmB;AAChC,QAAI,SAAS,IAAI,WAAJ,CAAgB,KAAhB,CAAsB,GAAtB,CAAb;AACA,QAAG,OAAO,MAAP,IAAiB,CAAjB,IAAsB,OAAO,CAAP,KAAa,OAAtC,EAA8C;AAC1C,YAAI,IAAI,OAAJ,CAAY,QAAZ,IAAwB,SAA5B,EAAuC;;AAEnC,oBAAQ,GAAR,CAAY,aAAZ;AACA,gBAAI,YAAY,QAAQ,OAAR,CAAgB,GAAhB,EAAqB,GAArB,CAAhB;AACA,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,sBAAZ;AACA;AACA;AACH,aAJD,MAIO;AACH,wBAAQ,GAAR,CAAY,cAAZ;AACA,yBAAS,IAAT,CAAc,GAAd,EAAmB,cAAnB;AACA;AACH;AACJ;AACJ;AACD;AACH,CAnBD","file":"session.js","sourcesContent":["let account = require(\"./account\");\r\nlet response = require(\"./response\");\r\nmodule.exports = (req, res, next)=> {\r\n    let urlArr = req.originalUrl.split(\"/\");\r\n    if(urlArr.length == 4 && urlArr[1] == \"table\"){\r\n        if (req.session.username == undefined) {\r\n            //try relogin\r\n            console.log(\"try relogin\");\r\n            let isSuccess = account.relogin(req, res);\r\n            if (isSuccess) {\r\n                console.log(\"relogin successfully\");\r\n                next();\r\n                return;\r\n            } else {\r\n                console.log(\"unauthorized\");\r\n                response.fail(res, \"unauthorized\");\r\n                return;\r\n            }\r\n        }\r\n    }\r\n    next();\r\n};"]}